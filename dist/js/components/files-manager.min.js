/**
 * @package     zlux
 * @version     2.1.0
 * @author      ZOOlanders - http://zoolanders.com
 * @license     GNU General Public License v2 or later
 */

!function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return t[n].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";var n=i(1),s=i(2).util;n.component("zx-files-manager",{boot:function(){return window.Vue?void Vue.component("files-manager",i(25)):void s.warn("Vue not loaded but required by Files Manager")}})},function(t,e){t.exports=UIkit},function(t,e){t.exports=Zlux},function(t,e,i){"use strict";var n=i(2).util;e.basename=function(t,e){var i=t,s=i.charAt(i.length-1);return("/"===s||"\\"===s)&&(i=i.slice(0,-1)),i=i.replace(/^.*[\/\\]/g,""),n.isString(e)&&i.substr(i.length-e.length)===e&&(i=i.substr(0,i.length-e.length)),i},e.cleanPath=function(t){return"/"===t?t:t.replace(/\/\/+/g,"/").replace(/^\/|\/$/g,"")},e.parseSize=function(t){if(!n.isString(t)||n.isEmpty(t))return t;var e,i={t:1099511627776,g:1073741824,m:1048576,k:1024};return t=/^([0-9]+)([mgk]?)$/.exec(t.toLowerCase().replace(/[^0-9mkg]/g,"")),e=t[2],t=+t[1],i.hasOwnProperty(e)&&(t*=i[e]),t},e.filesize=function(t){var e,i,n,s,a,o,r,c,u,l,h,p=/b$/,d={bits:["B","kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","kB","MB","GB","TB","PB","EB","ZB","YB"]},f=void 0===arguments[1]?{}:arguments[1],g=[],m=!1,v=0;if(isNaN(t))throw new Error("Invalid arguments");return n=f.bits===!0,u=f.unix===!0,i=void 0!==f.base?f.base:2,c=void 0!==f.round?f.round:u?1:2,l=void 0!==f.spacer?f.spacer:u?"":" ",h=void 0!==f.suffixes?f.suffixes:{},r=void 0!==f.output?f.output:"string",e=void 0!==f.exponent?f.exponent:-1,o=Number(t),a=0>o,s=i>2?1e3:1024,a&&(o=-o),0===o?(g[0]=0,u?g[1]="":g[1]="B"):((-1===e||isNaN(e))&&(e=Math.floor(Math.log(o)/Math.log(s))),e>8&&(v=1e3*v*(e-8),e=8),v=2===i?o/Math.pow(2,10*e):o/Math.pow(1e3,e),n&&(v=8*v,v>s&&(v/=s,e++)),g[0]=Number(v.toFixed(e>0?c:0)),g[1]=d[n?"bits":"bytes"][e],!m&&u&&(n&&p.test(g[1])&&(g[1]=g[1].toLowerCase()),g[1]=g[1].charAt(0),"B"===g[1]?(g[0]=Math.floor(g[0]),g[1]=""):n||"k"!==g[1]||(g[1]="K"))),a&&(g[0]=-g[0]),g[1]=h[g[1]]||g[1],"array"===r?g:"exponent"===r?e:"object"===r?{value:g[0],suffix:g[1]}:g.join(l)}},,,,,,,,,,,function(t,e){t.exports='<ul class="uk-breadcrumb uk-margin"><li><a href="" v-if=active v-on="click: select(this, \'/\')">{{ \'home\' | trans }}</a> <span v-if=!active>{{ \'home\' | trans }}</span></li><template v-repeat=crumbs><li v-if=location><a href="" v-on="click: select(this, location)">{{ name }}</a></li><li v-if=!location><span>{{ name }}</span></li></template><li v-if=active class=uk-active><span>{{ active.name }}</span></li></ul>'},function(t,e){t.exports='<li class=zx-files-manager-resource draggable=true><div v-on="click: selectItem" class="uk-panel uk-panel-box uk-panel-space uk-text-center" v-class="uk-active: selected"><span class=uk-panel-title><i class="uk-icon-large uk-icon-justify" v-class="\n                    uk-icon-folder-o: isFolder,\n                    uk-icon-file-image-o: isImage,\n                    uk-icon-file-o: isFile && !isImage\n                "></i></span><div class="uk-text-break uk-margin-top"><i class="uk-icon-{{ selected ? \'check-square-o\' : \'square-o\' }} uk-icon-justify"></i> <a v-if="type == \'folder\'" href=# v-on="click: goTo">{{ basename | title || \'..\' }}</a><template v-if="type == \'file\'">{{ basename | title || \'..\' }}</template></div></div></li>'},function(t,e){t.exports='<div class=zx-files-manager><div v-if="fetching && !resources.length" class=uk-text-center><i class="uk-icon-spinner uk-icon-spin uk-icon-small"></i></div><nav class=uk-navbar v-el=nav><form class="uk-form uk-margin-remove uk-display-inline-block uk-width-1-1" v-on="submit: search"><div class="uk-form-icon uk-width-1-1"><i v-class="filter ? \'uk-icon-times\' : \'uk-icon-search\'" v-on="click: clearSearch"></i> <input v-model=filter class="uk-form-blank uk-width-1-1" debounce=500 type=search></div></form></nav><div class=uk-margin><button v-el=browse type=button class="uk-button uk-button-small uk-button-primary uk-form-file">{{ \'Upload\' | trans }}</button> <button type=button v-on="click: createDir" class="uk-button uk-button-small">{{ \'Add Folder\' | trans }}</button> <button type=button v-on="click: reload" class="uk-button uk-button-small">{{ \'Reload\' | trans }}</button> <button v-if=selected.length type=button v-on="click: renameResource" class="uk-button uk-button-small" v-attr="disabled: selected.length > 1">{{ \'Rename\' | trans }}</button> <button v-if=selected.length type=button v-on="click: deleteSelected" class="uk-button uk-button-small uk-button-danger">{{ \'Delete\' | trans }}</button></div><breadcrumb location="{{ location }}" go-to="{{ goTo }}"></breadcrumb><div class=uk-overflow-container><ul class="uk-grid uk-grid-width-small-1-2 uk-grid-width-medium-1-3 uk-grid-width-xlarge-1-4" data-uk-grid-margin data-uk-grid-match="{target:\'.uk-panel\'}"><component is=resource v-repeat=resources></component></ul></div><div v-if=uploadProgress class=uk-progress><div class=uk-progress-bar v-style="width: uploadProgress + \'%\'"></div></div><div v-el=dropzone class="uk-placeholder uk-text-center uk-margin-bottom-remove"><i class="uk-icon-cloud-upload uk-icon-medium uk-text-muted uk-margin-small-right"></i> {{ \'Drop files here\' | trans }}</div><pagination v-if="total > itemsPerPage" items="{{ total }}" current-page="{{@ currentPage }}" items-on-page="{{ itemsPerPage }}" on-select-page="{{ changePage }}"></pagination></div>'},,,,,,,function(t,e,i){t.exports=i(32),t.exports.template=i(14)},function(t,e,i){t.exports=i(33),t.exports.template=i(15)},function(t,e,i){t.exports=i(34),t.exports.template=i(16)},,,,,,,function(t,e){t.exports={props:["location","goTo"],data:function(){return{active:null}},computed:{crumbs:function(){var t=[],e="";return this.location.replace(/^[\/]|[\/]$/gm,"").split("/").forEach(function(i){return""===i?!0:void t.push({name:i,location:e+="/"+i})}),this.$set("active",t.pop()),t.length>1&&t.splice(0,t.length-1,{name:"...",location:null}),t}},methods:{select:function(t,e){t.$event.preventDefault(),this.goTo(e)}}}},function(t,e,i){var n=i(3);t.exports={name:"resource",data:function(){return{basename:"",content_type:"",size:"",selected:!1}},computed:{type:function(){return this.basename.match(/\/$/)?"folder":"file"},isFolder:function(){return"folder"===this.type},isFile:function(){return!this.isFolder},isImage:function(){return this.isFile&&this.content_type.match("image")},path:function(){return n.cleanPath(this.$parent.location+"/"+this.basename)}},filters:{title:function(t){return t.replace(/\/$/g,"").replace(/(-|_)/g," ")},parseSize:function(t){return t?n.filesize(n.parseSize(t)):t}},methods:{selectItem:function(){this.$set("selected",!this.selected)},goTo:function(t){t.preventDefault(),this.$parent.goTo(this.path)}}}},function(t,e,i){var n=i(40),s=i(1),a=i(2),o=a.util,r=i(3);t.exports={props:{routeMap:{type:String,required:!0,"default":"filesManager"},extensions:{type:String,"default":""},maxFileSize:{type:String}},data:function(){return{location:"/",cache:{},resources:[],fetching:!1,filter:"",uploadProgress:0,itemsPerPage:10,currentPage:1,offset:0,count:0,total:0}},computed:{notice:function(){return this.notices.length?this.notices.join("\n"):!1},selected:function(){return this.resources.filter(function(t){return t.selected})}},created:function(){this.$watch("filter",function(t,e){""===e&&this.$set("currentPage",1),this.cache={},this.search()}),this.$watch("resources",function(t,e){n("[data-uk-grid-margin]",this.$el).each(function(){var t=n(this);t.data("gridMargin",null),t.data("stackMargin",null),s.gridMargin(t,s.Utils.options(t.attr("data-uk-grid-margin")))}),n("[data-uk-grid-match]",this.$el).each(function(){var t=n(this);t.data("gridMatchHeight",null),s.gridMatchHeight(t,s.Utils.options(t.attr("data-uk-grid-match")))})})},ready:function(){this.initPlupload()},methods:{changePage:function(t){this.fetch(null,t)},goTo:function(t){this.fetch(r.cleanPath(t))},reload:function(t){t&&t.preventDefault(),this.cache={},this.fetch(this.location,this.currentPage)},search:function(t){t&&t.preventDefault(),this.fetch()},clearSearch:function(){this.$set("filter",""),this.fetch()},setPageData:function(t){this.$set("location",t.location),this.$set("currentPage",t.page),this.$set("resources",t.resources),this.$set("count",t.count),this.$set("total",t.total),this.cache[t.location+t.page]=t},createDir:function(){var t=prompt("Choose name"),e=r.cleanPath(this.location+"/"+t);t&&this.$http.get(this.routeMap+"/createDir",{path:e}).done(function(t){this.reload()}).always(function(t){this.riseWarnings(t)})},renameResource:function(){var t=this.selected[0],e=r.cleanPath(this.location+"/"+t.basename),i=prompt("Choose new name for "+t.basename);i&&this.$http.get(this.routeMap+"/renameResource",{resource:e,new_name:i}).done(function(t){this.reload()}).always(function(t){this.riseWarnings(t)})},deleteSelected:function(){var t=this.selected.map(function(t){return r.cleanPath(this.location+"/"+t.basename)},this);this.$http.get(this.routeMap+"/deleteResources",{resources:t}).done(function(t){this.reload()}).always(function(t){this.riseWarnings(t)})},fetch:function(t,e){if(t=t||this.location,e=e||1,this.cache[t+e])return this.setPageData(this.cache[t+e]);var i=o.merge({location:t,limit:this.itemsPerPage,page:e,filter:this.filter},i||{});this.$set("fetching",!0),this.$http.get(this.routeMap+"/fetchResources",i).done(function(t){this.setPageData(t),o.isFunction(this.onLoadPage)&&this.onLoadPage()}).always(function(t){this.riseWarnings(t),this.$set("fetching",!1)})},riseWarnings:function(t){t.errors.length&&s.notify(t.errors.join("\n"),{pos:"top-right",status:"danger"}),t.notices.length&&s.notify(t.notices.join("\n"),{pos:"top-right",status:"warning"})},initPlupload:function(){var t=this,e=new plupload.Uploader({runtimes:"html5",browse_button:this.$$.browse,drop_element:this.$$.dropzone,max_file_size:this.maxFileSize,url:o.helper.getFulllRoute(this.routeMap+"/upload"),headers:{"X-XSRF-TOKEN":a.config.csrf},filters:[{title:"Files",extensions:this.extensions}],init:{FileUploaded:function(e,i,n){t.$set("uploadProgress",0),t.riseWarnings(JSON.parse(n.response))},FilesAdded:function(t,e){t.start()},UploadProgress:function(e,i){t.uploadProgress=isNaN(i.percent)?0:i.percent},UploadComplete:function(e,i){t.reload()},BeforeUpload:function(e,i){e.settings.url+="&location="+t.location}}});e.init()}},components:{resource:i(24),breadcrumb:i(23)}}},,,,,,function(t,e){t.exports=UIkit.$}]);